[{"_id":{"$oid":"62d541e98f662515a464d391"},"name":"Bahmni 2","baseUrl":"https://demo.mybahmni.org/","proxyUrl":"http://his.health.local:8090/bahmni/home/index.html","loginScript":"","logoutScript":"","proxyScript":"\ndef gatewayFilter = { exchange ->\n\n    scriptingApi.logInfo(scriptingApi.executeScript(exchange, ScriptType.LOGIN))\n    scriptingApi.addProxyResponseCookieIfNotPreset(exchange, \"bahmni.user\", \"%22\" + scriptingApi.getProxyUsername(exchange) + \"%22\", \"/\")\n    scriptingApi.addProxyResponseCookieIfNotPreset(exchange, \"bahmni.user.location\", \"%7B%22name%22%3A%22General%20Ward%22%2C%22uuid%22%3A%22baf7bd38-d225-11e4-9c67-080027b662ec%22%7D\", \"/\")\n}\n\nscriptingApi.createGatewayFilter(gatewayFilter)\n\ndef loginScript = { exchange ->\n\n    def password = scriptingApi.getProxyPassword(exchange)\n\n    if (password == null || \"\".equals(password)) {\n        return\n    }\n\n    def valueList = exchange.getRequest().getCookies().get(\"reporting_session\")\n\n    if (valueList == null || valueList.size() == 0) {\n        return\n    }\n\n    def sessionId = valueList.get(0).getValue()\n\n    def request = HttpRequest.newBuilder()\n                    .uri(new URI(\"https://demo.mybahmni.org/openmrs/ws/rest/v1/session?v=custom:(uuid)\")).GET()\n                    .header(\"Authorization\", scriptingApi.getBasicAuthenticationHeader(scriptingApi.getProxyUsername(exchange), scriptingApi.getProxyPassword(exchange)))\n                    .header(\"Cookie\", \"JSESSIONID=\" + sessionId + \"; reporting_session=\" + sessionId).build()\n\n    scriptingApi.logInfo(scriptingApi.executeRequest(request))\n}\n\nscriptingApi.setScript(ScriptType.LOGIN, loginScript)\n","resetScript":"","_class":"dev.heinzl.simplessoproxy.models.App"},{"_id":{"$oid":"62d9428fb0b55a59dbc7a339"},"name":"ERP","baseUrl":"https://erp.v-suite.healthcare/","proxyUrl":"http://erp.health.local:8090/web/login","proxyScript":"","_class":"dev.heinzl.simplessoproxy.models.App"}]